import{d as U,r as s,O as Q,w as C,o as m,c as g,a as e,n as p,t as i,b as W,e as M,T as X,f as Z,v as ee,F as te,p as oe,g as se,_ as $,h as ne,S as ae,i as ie}from"./_plugin-vue_export-helper-CEF5PBLk.js";const c=h=>(oe("data-v-86d2de08"),h=h(),se(),h),le=c(()=>e("div",{style:{margin:"20px","margin-top":"10px"}},"ROUND",-1)),re={style:{margin:"20px","margin-top":"10px",color:"black"}},ce=c(()=>e("div",{class:"side-panel-shutter",id:"side-left-shutter"},null,-1)),de=c(()=>e("div",{style:{margin:"20px","margin-top":"10px"}},"MUSIC",-1)),ue={style:{margin:"20px","margin-top":"10px",color:"black"}},_e=c(()=>e("div",{class:"side-panel-shutter",id:"side-right-shutter"},null,-1)),ve={id:"container"},pe={id:"bar-bottom-info-left-edge"},me={viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{right:"0"}},fe=c(()=>e("polygon",{points:"0,0 100,0 100,100",style:{fill:"black"}},null,-1)),ge=[fe],he={id:"bar-bottom-info-right-edge"},be={viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{left:"0"}},Se=c(()=>e("polygon",{points:"0,0 100,0 0,100",style:{fill:"black"}},null,-1)),ye=[Se],ke={id:"bar-left-edge"},we={viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{right:"0"}},Ce=c(()=>e("polygon",{points:"0,0 100,0 100,100",style:{fill:"white"}},null,-1)),Re=[Ce],xe={id:"bar-right-edge"},Te={viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{left:"0"}},Ne=c(()=>e("polygon",{points:"0,0 100,0 0,100",style:{fill:"white"}},null,-1)),Ee=[Ne],Ie={id:"coders-nameplates-container"},Oe={class:"coder-nameplate"},Ae={class:"coder-nameplate"},Be={class:"coder-nameplate"},P="ws://localhost:4455",k="ws://localhost:6969",De="http://localhost:8080",Ve="meubapelefoute",Pe=U({__name:"OverlayTop",async setup(h){let r,d;var b=!1;const S=s(""),n=s(!0),u=s(!0),_=s(!1),L=s(!1),w=s(!1),j=s(!1),R=s(""),x=s(""),T=s(""),F=s(""),N=s(""),E=s(""),z=s(""),G=s(""),v=s(0);var a={isRunning:!1,startTime:-1,startState:0},l;async function I(){const t=await fetch(`${De}/current_round`).catch(o=>{console.error(`Can't retrieve current round infos : ${o}`)});t&&t.status==200&&(console.log("Config loaded!"),l=await t.json(),R.value=l.round.coders[0],x.value=l.round.coders[1],T.value=l.round.coders[2],N.value=l.roundName,E.value=l.round.djName,z.value=l.round.commentsName,G.value=l.hostName)}function Y(){n.value=!n.value}function J(){u.value=!u.value}function q(){_.value=!_.value,L.value=!0}function O(t){if(t=="MAIN_COMPETITION")u.value=!0,n.value=!0,_.value=!1;else{u.value=!1,n.value=!1,_.value=!0;var o=/CODER(\d+)/.exec(t);if(o!=null){const V=Number(o[1])-1;F.value=l.round.coders[V],S.value=l.round.coders[V]}}}var A=null;function B(){if(a.isRunning){const t=a.startState-(Date.now()-a.startTime)/1e3;v.value=Math.max(t,0)}else v.value=a.startState}function H(){v.value<=10&&v.value>0?w.value=!0:w.value=!1}function K(){!a.isRunning&&A!=null&&clearInterval(A),B(),H()}const y=new WebSocket(k);y.addEventListener("open",()=>{console.log(`Connected to server ${k}.`)}),y.addEventListener("error",t=>{console.error(`Error with the server Websocket connection ${k}`)}),y.addEventListener("close",t=>{console.error(`Websocket connection with server ${k} closed.`)}),y.addEventListener("message",t=>{const o=JSON.parse(t.data);switch(o.type){case"TimerSetEvent":console.log(o),o.payload.time!=null?a.startState=o.payload.time:a.startState=v.value,o.payload.isRunning==!0&&a.isRunning!=!0?(a.isRunning=!0,a.startTime=Date.now(),window.setInterval(K,200)):a.isRunning=!1,B();break;case"ConfigEvent":o.payload.doUpdate&&I()}});const f=new Q;if([r,d]=C(()=>f.connect(P,Ve).then(()=>{b=!0}).catch(()=>{console.error(`Can't connect to OBS websockets ${P}`)})),await r,d(),f.on("SceneTransitionStarted",async function(t){const o=await f.call("GetCurrentProgramScene");O(o.currentProgramSceneName)}),f.on("ConnectionError",()=>{b=!1}),f.on("ConnectionClosed",()=>{b=!1}),[r,d]=C(()=>I()),await r,d(),b){const t=([r,d]=C(()=>f.call("GetCurrentProgramScene")),r=await r,d(),r);O(t.sceneName)}return(t,o)=>(m(),g(te,null,[e("div",{class:p(["side-panel",{make_grow_side_panel:n.value,make_shrink_side_panel:!n.value}]),id:"side-left-title"},[le,e("div",{class:p(["side-panel-content",{make_grow_side_panel_content:n.value,make_shrink_side_panel_content:!n.value}]),id:"side-left-content"},[e("div",re,i(N.value.toUpperCase()),1)],2),ce],2),e("div",{class:p(["side-panel",{make_grow_side_panel:n.value,make_shrink_side_panel:!n.value}]),id:"side-right-title"},[de,e("div",{class:p(["side-panel-content",{make_grow_side_panel_content:n.value,make_shrink_side_panel_content:!n.value}]),id:"side-right-content"},[e("div",ue,i(E.value.toUpperCase()),1)],2),_e],2),e("div",ve,[e("div",{id:"bar-center",class:p({make_timer_small:!u.value,make_timer_big:u.value,invert:j.value})},[e("div",{id:"bar-bottom-info",class:p({make_appear_bottom_infostrip:_.value,make_disappear_bottom_infostrip:!_.value})},[e("div",pe,[(m(),g("svg",me,[...ge]))]),e("div",he,[(m(),g("svg",be,[...ye]))]),W(X,{name:"slide-right"},{default:M(()=>[(m(),g("div",{id:"bar-bottom-info-text",key:t.bar-t.bottom-t.info-t.text-t.content},i(S.value),1))]),_:1})],2),e("div",ke,[(m(),g("svg",we,[...Re]))]),e("div",xe,[(m(),g("svg",Te,[...Ee]))]),e("div",{id:"timer-text",class:p({blink:w.value})},i(Math.floor(v.value/60).toString().padStart(2,"0"))+":"+i(Math.floor(v.value%60).toString().padStart(2,"0")),3)],2)]),e("div",Ie,[e("div",Oe,i(R.value),1),e("div",Ae,i(x.value),1),e("div",Be,i(T.value),1)]),Z(e("input",{type:"text",id:"bar-bottom-info-debug","onUpdate:modelValue":o[0]||(o[0]=D=>S.value=D),style:{position:"absolute",bottom:"0px",left:"0%"}},null,512),[[ee,S.value]]),e("button",{type:"button",onClick:q,style:{position:"absolute",bottom:"0px",left:"20%"}}," Toggle bottom info: "+i(_.value),1),e("button",{type:"button",onClick:Y,style:{position:"absolute",bottom:"0px",left:"40%"}}," Toggle edge: "+i(n.value),1),e("button",{type:"button",onClick:J,style:{position:"absolute",bottom:"0px",left:"60%"}}," Toggle timer: "+i(u.value),1)],64))}}),Ue=$(Pe,[["__scopeId","data-v-86d2de08"],["__file","/Users/diffty/_Projets/Streaming/2024_04_Revision2024/OVERLAY/src/components/OverlayTop.vue"]]),We=U({__name:"RevisionOverlayApp",setup(h){return(r,d)=>(m(),ne(ae,null,{default:M(()=>[W(Ue)]),_:1}))}}),Me=$(We,[["__file","/Users/diffty/_Projets/Streaming/2024_04_Revision2024/OVERLAY/src/RevisionOverlayApp.vue"]]);ie(Me).mount("#app");
